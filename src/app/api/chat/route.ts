import { google } from "@ai-sdk/google";
import { streamText } from "ai";
import { openai } from "@ai-sdk/openai";

export async function POST(req: Request) {
  try {
    const { prompt } = await req.json();

    const searchPrompt = `
ุงุจุญุซ ูู ุงูุฅูุชุฑูุช ุนู: "${prompt}"

ุงุนุฏ ุงููุญุชูู ุนูู ุดูู html, css content ุญุชู ุงุชููู ูู ุนุฑุถู ูู ุงูุตุญูู, ุงุฒุง ูุงู ุงููุญุชูู ุจุงููุบู ุงูุนุฑุจูู ุงุฌุนู ุงู dir="rtl" ูุงู ูุงู ุบูุฑ ุฐูู ุงุฌุนู ุงู dir="ltr"
ุงุณุชุฎุฏู cairo font ูุงุถู inline styles ุงุฌุนู ุงููุธูุฑ ุฌูููุง ูุงุฌูู ูููุงุก ุงูุตูุญู

ุชุนูููุงุช ูููุฉ:
1. ุงุจุญุซ ุฃููุงู ุจุงุณุชุฎุฏุงู google_search ุนู ุงููุนูููุงุช ุงููุทููุจุฉ
2. ุงุฌูุน ุฃูุจุฑ ุนุฏุฏ ูููู ูู ุงููุตุงุฏุฑ ุงูููุซููุฉ ูุงูุญุฏูุซุฉ
3. ุงุนุฑุถ ุงููุตุงุฏุฑ ุจุชูุณูู ูุงุถุญ ูู ุจุฏุงูุฉ ุฅุฌุงุจุชู
4. ูุฏู ููุฎุต ุดุงูู ููููุฏ ุจูุงุกู ุนูู ุงููุตุงุฏุฑ

ุชูุณูู ุงูุฅุฌุงุจุฉ ุงููุทููุจ:

## ๐ ุงููุตุงุฏุฑ ุงููุฑุฌุนูุฉ:

1. **[ุนููุงู ุงูููุงู/ุงูุตูุญุฉ]** - [ุงุณู ุงููููุน]
   - ุงูุฑุงุจุท: [URL ูุงูู]
   - ุชุงุฑูุฎ ุงููุดุฑ: [ุฅุฐุง ูุงู ูุชููุฑุงู]
   - ููุฎุต ูุฎุชุตุฑ: [2-3 ุฌูู ุนู ูุญุชูู ุงููุตุฏุฑ]

2. **[ุนููุงู ุงูููุงู/ุงูุตูุญุฉ]** - [ุงุณู ุงููููุน]
   - ุงูุฑุงุจุท: [URL ูุงูู]
   - ุชุงุฑูุฎ ุงููุดุฑ: [ุฅุฐุง ูุงู ูุชููุฑุงู]
   - ููุฎุต ูุฎุชุตุฑ: [2-3 ุฌูู ุนู ูุญุชูู ุงููุตุฏุฑ]

[ุงุณุชูุฑ ุจููุณ ุงูุชูุณูู ูุฌููุน ุงููุตุงุฏุฑ]

---

## ๐ ุงูููุฎุต ุงูุชูุตููู:

[ุงูุชุจ ููุง ููุฎุต ุดุงูู ูููุตู ุจูุงุกู ุนูู ุฌููุน ุงููุตุงุฏุฑ ุงูุชู ูุฌุฏุชูุงุ ูุน ุฐูุฑ ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ ูุงูุชูุงุตูู ุงููููุฉ]

## ๐ฏ ุงูููุงุท ุงูุฑุฆูุณูุฉ:

- [ููุทุฉ ูููุฉ 1]
- [ููุทุฉ ูููุฉ 2]
- [ููุทุฉ ูููุฉ 3]

---
*ุชู ุงูุจุญุซ ูู ${new Date().toLocaleDateString("ar-SA")} ุจุงุณุชุฎุฏุงู Google Search*
`;

    const result = streamText({
      model: google("gemini-2.5-flash"),
      tools: {
        google_search: google.tools.googleSearch({}),
      },
      prompt: searchPrompt,
    });

    return result.toUIMessageStreamResponse();
  } catch (error) {
    console.error(error);
    return new Response("Failed to generate text", { status: 500 });
  }
}
